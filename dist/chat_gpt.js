import{d as C,r as u,l as at,o as s,c,z as X,n as N,a as d,t as D,h as _,b as j,w as T,e as P,y as nt,i as B,k as v,f as W,u as m,F as H,_ as K,g as st,D as ht,E as ft,G as gt,s as G,m as Y,j as tt,H as xt,p as vt,q as bt}from"./wug-style.js";import{e as ot}from"./tools.js";function it(t,a){for(let e=0;e<t.length;e++)if(!a.includes(t[e]))return!1;return!0}function lt(t){return t.filter(a=>a.isMandatory).map(a=>a.id)}function _t(t){return/^[a-zA-Z0-9._+-]+@[a-zA-Z0-9_+-]+\.[a-zA-Z]{2,}$/.test(t)}const J=C({__name:"chat-alert",props:{type:{type:String,default:"info"},timeout:{type:Number,default:0}},setup(t){const a=t,e=u(!0);return at(()=>{a.timeout!==0&&setTimeout(()=>{e.value=!1},a.timeout)}),(o,n)=>(s(),c("div",{class:N(["tw-border-l-4 tw-p-2 tw-rounded tw-bg-white tw-border tw-text-base",{"tw-border-blue-500 ":t.type==="info","tw-border-orange-500 ":t.type==="warning","tw-border-green-500 ":t.type==="success","tw-border-red-500 ":t.type==="error","tw-hidden":!e.value}]),role:"alert"},[X(o.$slots,"default")],2))}}),Ct={class:"tw-flex tw-gap-2 tw-text-black tw-text-sm tw-items-center tw-relative"},yt=["id","name"],$t=d("svg",{class:"tw-absolute tw-w-4 tw-h-4 tw-hidden peer-checked:tw-block",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[d("polyline",{points:"20 6 9 17 4 12"})],-1),kt={href:"#",className:"tw-underline"},rt=C({__name:"chat-checkbox",props:{id:String,name:String,isMandatory:Boolean},emits:["accepted-campaign","update:modal-id-opened"],setup(t,{emit:a}){const e=a;return(o,n)=>(s(),c("label",Ct,[d("input",{id:`campaign-${t.id}`,name:`campaign-${t.id}`,type:"checkbox",onChange:n[0]||(n[0]=i=>e("accepted-campaign",t.id)),class:"!tw-appearance-none tw-peer before:!tw-hidden !tw-w-4 !tw-h-4 !tw-border !tw-border-black !tw-rounded-none !tw-bg-white"},null,40,yt),$t,d("div",{class:"tw-flex tw-gap-2",onClick:n[1]||(n[1]=i=>e("update:modal-id-opened",t.id))},[d("a",kt,D(t.name),1)]),d("span",{class:N({"tw-text-red-500 tw-text-xs":t.isMandatory,"tw-hidden":!t.isMandatory})}," (mandatory) ",2)]))}}),At=["disabled"],ct=C({__name:"chat-button",props:{disabled:Boolean},emits:["click"],setup(t,{emit:a}){const e=a;return(o,n)=>(s(),c("button",{class:"tw-text-sm tw-uppercase tw-px-4 tw-py-3 tw-rounded-xl tw-text-white tw-transition-all tw-duration-300 tw-shadow-button tw-bg-blue-500 hover:tw-bg-blue-600 active:tw-bg-blue-700 tw-no-underline disabled:tw-opacity-50 disabled:tw-cursor-not-allowed",onClick:n[0]||(n[0]=i=>e("click")),disabled:t.disabled},[X(o.$slots,"default")],8,At))}}),Mt=["id","name"],Ft={key:0,className:"tw-text-xl"},It={className:"tw-flex tw-justify-end"},dt=C({__name:"chat-form",props:{title:String,disabled:Boolean,accept:Function,id:String},emits:["submit"],setup(t,{emit:a}){const e=a;return(o,n)=>(s(),c("form",{id:t.id,name:t.id,className:"tw-flex tw-flex-col tw-gap-2 tw-text-black",onSubmit:n[0]||(n[0]=nt(i=>e("submit"),["prevent"]))},[t.title?(s(),c("div",Ft,D(t.title),1)):_("",!0),X(o.$slots,"default"),d("div",It,[j(ct,{disabled:t.disabled,type:"submit"},{default:T(()=>[P("Accept")]),_:1},8,["disabled"])])],40,Mt))}}),St={className:"tw-flex tw-flex-col tw-gap-1"},Et=C({__name:"chat-ai-chat-form",emits:["form-accepted"],setup(t,{emit:a}){const e=B("setModalIdOpen"),o=B("chatGptData");if(!o)throw new Error("chatGptData is undefined");const{aiChatCampaigns:n}=o,i=u([]),l=u(!1),r=a;function w(I){const b=i.value.indexOf(I);b===-1?i.value=[...i.value,I]:i.value.splice(b,1),it(lt(n),i.value.map(S=>S.toString()))?l.value=!0:l.value=!1}function h(){r("form-accepted",i.value)}return(I,b)=>(s(),v(J,{type:"info"},{default:T(()=>[j(dt,{id:"ai-chat-campaigns-form",title:"Ai Chat Campaigns",disabled:!l.value,onSubmit:h},{default:T(()=>[d("div",St,[(s(!0),c(H,null,W(m(n),M=>(s(),v(rt,{key:M.id,id:M.id,name:M.name,isMandatory:M.isMandatory,onAcceptedCampaign:w,"onUpdate:modalIdOpened":m(e)},null,8,["id","name","isMandatory","onUpdate:modalIdOpened"]))),128))])]),_:1},8,["disabled"])]),_:1}))}}),Bt=({ajaxUrl:t,action:a,queryField:e,aiChatterId:o,message:n,aiChatId:i,nonce:l})=>{const r=new FormData;return r.append("action",a),r.append(`data[${e}]`,n),r.append("data[aiChatterId]",o),i&&r.append("data[aiChatId]",i.toString()),r.append("security",l),fetch(t,{method:"POST",body:r}).then(w=>w.ok?w.json():w.text().then(h=>{throw new Error(h)})).catch(w=>{throw w})},Dt=({ajaxUrl:t,action:a,nonce:e,aiChatCampaigns:o,campaignIds:n})=>{const i=new FormData;return i.append("action",a),i.append(`data[${o}][]`,n.join(",")),i.append("security",e),fetch(t,{method:"POST",body:i}).then(l=>l.ok?l.json():l.text().then(r=>{throw new Error(r)})).catch(l=>{throw l})},Lt=({ajaxUrl:t,action:a,nonce:e,msg:o,aiChatId:n,role:i})=>{const l=new FormData;return l.append("action",a),l.append("data[aiChatMessage]",JSON.stringify({role:i,content:o})),l.append("data[aiChatId]",(n==null?void 0:n.toString())??""),l.append("security",e),fetch(t,{method:"POST",body:l}).then(r=>r.ok?r.json():r.text().then(w=>{throw new Error(w)})).catch(r=>{throw r})},jt=({ajaxUrl:t,action:a,nonce:e,fields:o,campaignIds:n,aiChatterId:i,aiChatId:l})=>{const r=new FormData;return r.append("action",a),r.append("security",e),r.append("data[fields]",o),r.append("data[campaignIds]",n.join(",")),r.append("data[aiChatterId]",i),r.append("data[aiChatId]",l),fetch(t,{method:"POST",body:r}).then(w=>w.ok?w.json():w.text().then(h=>{throw new Error(h)})).catch(w=>{throw w})},Ot={class:"tw-flex tw-flex-col tw-gap-1 tw-relative tw-pb-4 tw-text-base"},qt={class:"tw-flex tw-gap-2 tw-items-center"},zt={key:0,class:"tw-text-red-500 tw-text-xs"},Tt=["type","name","id","aria-errormessage"],Vt={key:0,id:"`${id}-error`",class:"tw-text-red-500 tw-text-xs tw-absolute tw-bottom-0"},Gt=C({__name:"chat-input-field",props:{label:String,type:String,id:String,required:Boolean,handleFilledField:Function},setup(t){const a=t,{handleFilledField:e,id:o,required:n}=a,i=u(""),l=u(null);function r(h){const b=h.target.value.trim();i.value=b,w(b)}function w(h){return!h&&n?(l.value="This fields is required",e(o,""),!0):o==="email"&&!_t(h)?(l.value="Please enter a valid email address",e(o,""),!0):(l.value=null,e(o,h),!1)}return(h,I)=>(s(),c("label",Ot,[d("div",qt,[P(D(t.label)+" ",1),m(n)?(s(),c("span",zt,"(required)")):_("",!0)]),d("input",{type:t.type,name:m(o),id:m(o),class:"tw-border tw-border-gray-300 tw-rounded tw-px-2 tw-py-1",onInput:r,"aria-errormessage":`${m(o)}-error`},null,40,Tt),l.value?(s(),c("div",Vt,D(l.value),1)):_("",!0)]))}}),Ht={class:"tw-flex tw-flex-col tw-gap-1 tw-relative tw-pb-4 tw-text-base"},Nt={class:"tw-flex tw-gap-2 tw-items-center"},Ut={key:0,class:"tw-text-red-500 tw-text-xs"},Qt=["name","id","aria-errormessage"],Pt=["id"],Zt=C({__name:"chat-textarea-field",props:{label:String,id:String,required:Boolean,handleFilledField:Function},setup(t){const a=t,e=u(""),o=u(null);function n(l){l.preventDefault();const r=l.target;e.value=r.value}function i(){if(!e.value&&a.required){o.value="This fields is required";return}e.value&&(a.handleFilledField(a.id,e.value),o.value=null)}return(l,r)=>(s(),c("label",Ht,[d("div",Nt,[P(D(t.label)+" ",1),t.required?(s(),c("span",Ut,"(required)")):_("",!0)]),d("textarea",{name:t.id,id:t.id,class:"tw-border tw-border-gray-300 tw-rounded tw-px-2 tw-py-1 tw-min-h-[100px]",onChange:n,onBlur:i,"aria-errormessage":`${t.id}-error`},null,40,Qt),d("div",{id:`${t.id}-error`,class:"tw-text-red-500 tw-text-xs tw-absolute tw-bottom-0"},D(o.value),9,Pt)]))}}),Rt={key:1,className:"tw-flex tw-flex-col tw-gap-1"},Jt=C({__name:"chat-ai-contact-form",setup(t){const a=B("chatGptData");if(!a)throw new Error("Missing dependencies");const e=B("setModalIdOpen"),o=B("setAllowChatInput"),n=B("aiChatId"),i=B("setIsAcceptedAiContactForm"),l=B("setErrorMessage"),{aiContactCampaigns:r,formFields:w,ajaxUrl:h,ajaxActionCreateAiContact:I,nonceAiContact:b,aiChatterId:M,allowAiContactCampaigns:S,afterFormMessageError:E}=a,L=u([]),y=u(!1),f=u(!1),g=u(null),F=u({name:"",email:"",phone:"",message:""});function U(p){const V=L.value.indexOf(p);V===-1?L.value=[...L.value,p]:L.value.splice(V,1),it(lt(r),L.value.map(z=>z.toString()))?f.value=!0:f.value=!1}function O(p,V){F.value={...F.value,[p]:V},w.filter(z=>z.required&&z.active).every(z=>F.value[z.label.toLowerCase()])?y.value=!0:y.value=!1}async function Q(){if(n)try{const p=await jt({ajaxUrl:h,action:I,nonce:b,fields:JSON.stringify(F),campaignIds:L.value,aiChatterId:M,aiChatId:n});g.value=p,i(!0),o(!1),l("")}catch{o(!1),l(E)}}const Z=w.filter(p=>p.active),R=Z.filter(p=>p.type!=="textarea"),q=Z.find(p=>p.type==="textarea");return at(()=>{(r.length===0||!S)&&(f.value=!0)}),(p,V)=>(s(),v(J,{type:"info",class:"tw-mb-4"},{default:T(()=>[j(dt,{title:"Ai Contact Form",disabled:!f.value||!y.value,onSubmit:Q},{default:T(()=>[(s(!0),c(H,null,W(m(R),k=>(s(),v(Gt,{key:k.label,label:k.label,type:k.type,id:k.label.toLowerCase(),required:k.required,handleFilledField:O},null,8,["label","type","id","required"]))),128)),m(q)?(s(),v(Zt,{key:0,label:m(q).label,id:m(q).label.toLowerCase(),required:m(q).required,handleFilledField:O},null,8,["label","id","required"])):_("",!0),m(S)?(s(),c("div",Rt,[(s(!0),c(H,null,W(m(r),k=>(s(),v(rt,{key:k.id,id:k.id,name:k.name,isMandatory:k.isMandatory,onAcceptedCampaign:U,"onUpdate:modalIdOpened":m(e)},null,8,["id","name","isMandatory","onUpdate:modalIdOpened"]))),128))])):_("",!0)]),_:1},8,["disabled"])]),_:1}))}}),Wt=["innerHTML"],et=C({__name:"chat-bot-message",props:{isExpanded:Boolean,message:String},setup(t){return(a,e)=>(s(),c("div",{class:N(["chat-message tw-text-base tw-gap-4 tw-flex tw-flex-col tw-from-blue-400 tw-to-blue-500 tw-self-end tw-rounded-b-2xl tw-rounded-tl-2xl tw-bg-gradient-to-b tw-px-6 tw-pt-1 tw-pb-2 tw-text-white",{"max-w-[700px]":t.isExpanded,"max-w-[414px]":!t.isExpanded}]),innerHTML:t.message},null,10,Wt))}}),Kt={},Xt={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"currentColor"},Yt=d("path",{d:"M16.1 260.2c-22.6 12.9-20.5 47.3 3.6 57.3L160 376V479.3c0 18.1 14.6 32.7 32.7 32.7c9.7 0 18.9-4.3 25.1-11.8l62-74.3 123.9 51.6c18.9 7.9 40.8-4.5 43.9-24.7l64-416c1.9-12.1-3.4-24.3-13.5-31.2s-23.3-7.5-34-1.4l-448 256zm52.1 25.5L409.7 90.6 190.1 336l1.2 1L68.2 285.7zM403.3 425.4L236.7 355.9 450.8 116.6 403.3 425.4z"},null,-1),te=[Yt];function ee(t,a){return s(),c("svg",Xt,te)}const ae=K(Kt,[["render",ee]]),ne=["disabled"],se={class:"tw-w-10 tw-h-10 tw-border tw-rounded-full tw-border-gray-400 tw-flex tw-justify-center tw-items-center !tw-bg-white disabled:tw-opacity-30 disabled:tw-cursor-not-allowed focus:tw-outline-none focus:tw-ring-2 focus:tw-ring-blue-500"},oe=C({__name:"chat-footer",props:{allowChatInput:{type:Boolean},aiChatId:{},remainingQuestions:{}},emits:["update:remaining-questions","update:messages","update:error-message"],setup(t,{emit:a}){const e=B("chatGptData");if(!e)throw new Error("chatGptData is undefined");const o=B("setAllowChatInput");if(!o)throw new Error("setAllowChatInput is undefined");const{ajaxUrl:n,ajaxActionChatBot:i,nonceChatBot:l,queryField:r,aiChatterId:w,ajaxActionRecordAiChat:h,nonceAiChat:I}=e,b=t,M=a,S=u(!1),E=u("");async function L(){if(S.value=!0,!!E.value)try{const f=await Bt({ajaxUrl:n,action:i,queryField:r,aiChatterId:w,message:E.value,aiChatId:b.aiChatId,nonce:l});y(E.value,"user"),y(f,"system"),S.value=!1,E.value=""}catch(f){console.log("🚀 ~ handleSubmit ~ error:",f),S.value=!1,E.value="";const g=ot(f);M("update:error-message",g)}}function y(f,g){g==="system"&&M("update:remaining-questions",b.remainingQuestions-1),b.aiChatId&&Lt({ajaxUrl:n,action:h,nonce:I,msg:f,aiChatId:b.aiChatId,role:g}),b.remainingQuestions===0&&o(!1),M("update:messages",{message:f,type:g})}return(f,g)=>(s(),c("form",{class:"tw-flex tw-mb-6 sm:tw-mb-0 tw-gap-2",onSubmit:nt(L,["prevent"]),name:"chat-footer"},[st(d("input",{type:"text",id:"message","onUpdate:modelValue":g[0]||(g[0]=F=>E.value=F),disabled:S.value||!f.allowChatInput,class:"tw-grow tw-align-center !tw-border-gray-400 tw-flex !tw-rounded-full !tw-border !tw-px-6 !tw-pt-1 !tw-pb-2 !tw-text-base tw-shadow-lg disabled:tw-opacity-30 disabled:tw-cursor-not-allowed focus:tw-outline-none focus:tw-ring-2 focus:tw-ring-blue-500"},null,8,ne),[[ht,E.value]]),d("button",se,[j(ae,{class:"tw-w-6 tw-h-6 tw-text-gray-400"})])],32))}}),ie={},le={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 512 512"},re=d("path",{d:"M200 32H56C42.7 32 32 42.7 32 56V200c0 9.7 5.8 18.5 14.8 22.2s19.3 1.7 26.2-5.2l40-40 79 79-79 79L73 295c-6.9-6.9-17.2-8.9-26.2-5.2S32 302.3 32 312V456c0 13.3 10.7 24 24 24H200c9.7 0 18.5-5.8 22.2-14.8s1.7-19.3-5.2-26.2l-40-40 79-79 79 79-40 40c-6.9 6.9-8.9 17.2-5.2 26.2s12.5 14.8 22.2 14.8H456c13.3 0 24-10.7 24-24V312c0-9.7-5.8-18.5-14.8-22.2s-19.3-1.7-26.2 5.2l-40 40-79-79 79-79 40 40c6.9 6.9 17.2 8.9 26.2 5.2s14.8-12.5 14.8-22.2V56c0-13.3-10.7-24-24-24H312c-9.7 0-18.5 5.8-22.2 14.8s-1.7 19.3 5.2 26.2l40 40-79 79-79-79 40-40c6.9-6.9 8.9-17.2 5.2-26.2S209.7 32 200 32z"},null,-1),ce=[re];function de(t,a){return s(),c("svg",le,ce)}const ue=K(ie,[["render",de]]),we={},me={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 512 512"},pe=d("path",{d:"M456 224H312c-13.3 0-24-10.7-24-24V56c0-9.7 5.8-18.5 14.8-22.2s19.3-1.7 26.2 5.2l40 40L442.3 5.7C446 2 450.9 0 456 0s10 2 13.7 5.7l36.7 36.7C510 46 512 50.9 512 56s-2 10-5.7 13.7L433 143l40 40c6.9 6.9 8.9 17.2 5.2 26.2s-12.5 14.8-22.2 14.8zm0 64c9.7 0 18.5 5.8 22.2 14.8s1.7 19.3-5.2 26.2l-40 40 73.4 73.4c3.6 3.6 5.7 8.5 5.7 13.7s-2 10-5.7 13.7l-36.7 36.7C466 510 461.1 512 456 512s-10-2-13.7-5.7L369 433l-40 40c-6.9 6.9-17.2 8.9-26.2 5.2s-14.8-12.5-14.8-22.2V312c0-13.3 10.7-24 24-24H456zm-256 0c13.3 0 24 10.7 24 24V456c0 9.7-5.8 18.5-14.8 22.2s-19.3 1.7-26.2-5.2l-40-40L69.7 506.3C66 510 61.1 512 56 512s-10-2-13.7-5.7L5.7 469.7C2 466 0 461.1 0 456s2-10 5.7-13.7L79 369 39 329c-6.9-6.9-8.9-17.2-5.2-26.2s12.5-14.8 22.2-14.8H200zM56 224c-9.7 0-18.5-5.8-22.2-14.8s-1.7-19.3 5.2-26.2l40-40L5.7 69.7C2 66 0 61.1 0 56s2-10 5.7-13.7L42.3 5.7C46 2 50.9 0 56 0s10 2 13.7 5.7L143 79l40-40c6.9-6.9 17.2-8.9 26.2-5.2s14.8 12.5 14.8 22.2V200c0 13.3-10.7 24-24 24H56z"},null,-1),he=[pe];function fe(t,a){return s(),c("svg",me,he)}const ge=K(we,[["render",fe]]),xe=C({__name:"chat-maximize-button",props:{isExpanded:Boolean},emits:["expand-chat"],setup(t,{emit:a}){const e=a;function o(n){n.stopPropagation(),e("expand-chat")}return(n,i)=>(s(),c("button",{onClick:i[0]||(i[0]=l=>e("expand-chat")),class:"tw-absolute tw-top-2 sm:-tw-top-12 tw-left-0 tw-hidden sm:tw-block"},[j(ue,{onClick:o,class:N(["tw-h-6 tw-w-6 sm:tw-w-10 sm:tw-h-10 tw-text-blue-500",{"tw-block":!t.isExpanded,"tw-hidden":t.isExpanded}])},null,8,["class"]),j(ge,{onClick:o,class:N(["tw-h-6 tw-w-6 sm:tw-w-10 sm:tw-h-10 tw-text-blue-500",{"tw-block":t.isExpanded,"tw-hidden":!t.isExpanded}])},null,8,["class"])]))}}),ve={class:"tw-fixed tw-z-40 tw-inset-0 tw-w-full tw-h-full tw-bg-black tw-justify-center tw-items-center tw-flex tw-bg-opacity-50",tabindex:"-1"},be={class:"tw-bg-white tw-rounded tw-w-full tw-max-w-lg tw-min-w-md tw-h-96 tw-flex tw-flex-col"},_e={class:"tw-p-4 tw-border-b"},Ce=["innerHTML"],ye={class:"tw-flex tw-justify-end tw-border-t tw-p-4"},$e=C({__name:"chat-modal",props:{id:String,name:String,content:String,isVisible:Boolean},emits:["close-modal"],setup(t,{emit:a}){const e=a;function o(n){e("close-modal",n)}return(n,i)=>st((s(),c("div",ve,[d("div",be,[d("header",_e,D(t.name),1),d("main",{class:"tw-grow tw-p-4 tw-overflow-y-scroll",innerHTML:t.content},null,8,Ce),d("footer",ye,[j(ct,{onClick:i[0]||(i[0]=l=>o(t.id))},{default:T(()=>[P("Close")]),_:1})])])],512)),[[ft,t.isVisible]])}}),ke={},Ae={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"413",height:"413",viewBox:"0 0 413 413"},Me=gt('<defs><linearGradient id="hall-9000-gradient" x1="1" y1="1" x2="0.081" y2="0.124" gradientUnits="objectBoundingBox"><stop offset="0" stop-color="#6d86d6"></stop><stop offset="1" stop-color="#48c4ee"></stop></linearGradient></defs><rect fill="url(#hall-9000-gradient)" width="413" height="413" rx="206.5"></rect><circle fill="#fff" cx="74.189" cy="74.189" r="74.189" transform="translate(131.178 134.023)"></circle><circle fill="#fff" cx="35.382" cy="35.382" r="35.382" transform="translate(278.414 96.358)"></circle><path fill="#fff" d="M132.445,0C61.11,0,2.9,58.209,2.9,129.545S61.11,259.089,132.445,259.089,261.989,200.88,261.989,129.545,203.78,0,132.445,0Zm0,245.393A115.848,115.848,0,1,1,248.293,129.545,115.932,115.932,0,0,1,132.445,245.393Z" transform="translate(72.922 76.955)"></path>',5),Fe=[Me];function Ie(t,a){return s(),c("svg",Ae,Fe)}const Se=K(ke,[["render",Ie]]),Ee=C({__name:"chat-open-button",props:{isOpen:Boolean},emits:["open-chat"],setup(t,{emit:a}){const e=a;return(o,n)=>(s(),c("button",{onClick:n[1]||(n[1]=i=>e("open-chat")),class:"tw-fixed tw-bottom-2 tw-right-2 sm:tw-bottom-6 sm:tw-right-6 tw-z-20"},[j(Se,{class:"tw-w-8 tw-h-8 sm:tw-w-16 sm:tw-h-16 tw-rounded-full tw-duration-300 hover:tw-rotate-90",onClick:n[0]||(n[0]=i=>e("open-chat"))})]))}}),Be={class:"tw-absolute sm:-tw-top-12 tw-right-0 tw-items-center tw-justify-center tw-gap-2 tw-rounded-2xl tw-bg-white tw-pl-2 tw-pr-4 tw-shadow-lg tw-hidden sm:tw-flex"},De=d("div",{class:"tw-bg-blue-500 tw-h-8 tw-w-8 tw-rounded-full"},null,-1),Le=d("div",{class:"tw-relative -tw-top-1 tw-text-2xl"},"tokens left",-1),je={class:"tw-relative -tw-top-1 tw-text-4xl tw-font-bold"},Oe=d("div",{class:"tw-absolute tw-bottom-2 tw-left-4 sm:tw-hidden"}," {ramainingQuestions} tokens left ",-1),qe=C({__name:"chat-tokens",props:{ramainingQuestions:Number},setup(t){return(a,e)=>(s(),c(H,null,[d("div",Be,[De,Le,d("div",je,D(t.ramainingQuestions),1)]),Oe],64))}}),ze=["innerHTML"],Te=C({__name:"chat-user-message",props:{isExpanded:Boolean,message:String},setup(t){return(a,e)=>(s(),c("div",{class:N(["tw-from-gray-200 tw-text-base tw-to-gray-300 tw-border-gray-400 tw-text-gray-700 tw-rounded-t-2xl tw-rounded-br-2xl tw-border tw-bg-gradient-to-t tw-px-6 tw-pt-1 tw-pb-2",{"max-w-[700px]":t.isExpanded,"max-w-[414px]":!t.isExpanded}]),innerHTML:t.message},null,10,ze))}}),Ve=C({__name:"chat-gpt",setup(t){const a=B("chatGptData");if(!a)throw new Error("chatGptData is undefined");const{isActive:e,initMessage:o,campaigns:n,limitChat:i,hasAiChat:l,ajaxUrl:r,ajaxActionCreateAiChat:w,nonceAiChat:h,aiChatCampaignsField:I,beforeFormMessage:b,questionsLimit:M,aiChatCampaigns:S,afterFormMessageSuccess:E,allowAiChatCampaigns:L}=a,y=u(!1),f=u(null),g=u(!1),F=u(M),U=u(null),O=u(!1),Q=u(!1),Z=u(!1),R=u([]),q=u(null),p=u(null);G("aiChatId",U),G("setAiChatId",x=>{U.value=x}),G("setModalIdOpen",x=>{f.value=x}),G("setIsAcceptedAiChatForm",x=>{Q.value=x}),G("setIsAcceptedAiContactForm",x=>{Z.value=x}),G("setAllowChatInput",x=>{O.value=x}),G("setErrorMessage",x=>{p.value=x});async function V(x){try{const $=await Dt({ajaxUrl:r,action:w,nonce:h,aiChatCampaigns:I,campaignIds:x});U.value=$.aiChatId,Q.value=!0,O.value=!0}catch($){console.log($),p.value=ot($)}}Y(y,()=>{y.value&&!U.value&&l&&!L&&(V([]),O.value=!0),y.value&&!l&&(Q.value=!0,O.value=!0)});const k=tt(()=>!Q.value&&l&&S.length>0),z=tt(()=>F.value===0&&!Z.value&&i);function wt(x){V(x)}function mt(x){R.value=[...R.value,x]}function pt(){q.value&&(q.value.scrollTop=q.value.scrollHeight)}return Y(F,()=>{F.value===0&&(O.value=!1)}),xt(()=>{pt()}),(x,$)=>(s(),c(H,null,[m(e)?(s(),c("div",{key:0,class:N(["tw-inset-0 tw-w-full tw-h-full tw-bg-black tw-justify-center tw-items-center tw-flex tw-bg-opacity-70 tw-z-20",{"tw-hidden":!y.value,"tw-fixed":y.value}])},[d("div",{class:N(["tw-relative tw-flex tw-flex-col tw-text-xl tw-w-full tw-h-full tw-min-h-full tw-p-4 sm:tw-p-6 tw-border-2 sm:tw-border-gray-300 sm:tw-rounded-3xl tw-shadow-card tw-bg-white",{"sm:tw-h-5/6 sm:tw-w-[900px] sm:tw-min-h-[600px] tw-mx-4":g.value,"sm:tw-h-4/6 sm:tw-w-[537px] sm:tw-min-h-[500px]":!g.value}])},[d("main",{class:"tw-flex tw-flex-grow tw-flex-col tw-gap-3 sm:tw-gap-7 tw-overflow-y-auto tw-mb-4",ref_key:"chatContainer",ref:q},[k.value?(s(),v(Et,{key:0,onFormAccepted:wt})):_("",!0),Q.value?(s(),v(et,{key:1,message:m(o),isExpanded:g.value},null,8,["message","isExpanded"])):_("",!0),(s(!0),c(H,null,W(R.value,A=>(s(),c(H,null,[A.type==="user"?(s(),v(Te,{key:0,message:A.message},null,8,["message"])):(s(),v(et,{key:1,message:A.message,isExpanded:g.value},null,8,["message","isExpanded"]))],64))),256)),z.value?(s(),v(J,{key:2,type:"warning"},{default:T(()=>[P(D(m(b)),1)]),_:1})):_("",!0),z.value?(s(),v(Jt,{key:3})):_("",!0),Z.value?(s(),v(J,{key:4,type:"success"},{default:T(()=>[P(D(m(E)),1)]),_:1})):_("",!0),p.value?(s(),v(J,{key:5,type:"error"},{default:T(()=>[P(D(p.value),1)]),_:1})):_("",!0)],512),j(oe,{allowChatInput:O.value,aiChatId:U.value,remainingQuestions:F.value,"onUpdate:remainingQuestions":$[0]||($[0]=A=>F.value=A),"onUpdate:messages":mt,"onUpdate:errorMessage":$[1]||($[1]=A=>p.value=A)},null,8,["allowChatInput","aiChatId","remainingQuestions"]),m(i)?(s(),v(qe,{key:0,ramainingQuestions:F.value},null,8,["ramainingQuestions"])):_("",!0),j(xe,{isExpanded:g.value,onExpandChat:$[2]||($[2]=A=>g.value=!g.value)},null,8,["isExpanded"])],2)],2)):_("",!0),m(e)?(s(!0),c(H,{key:1},W(m(n),A=>(s(),v($e,{name:A.name,content:A.content,id:A.id,isVisible:A.id===f.value,onCloseModal:$[3]||($[3]=He=>f.value=null)},null,8,["name","content","id","isVisible"]))),256)):_("",!0),m(e)?(s(),v(Ee,{key:2,onClick:$[4]||($[4]=A=>y.value=!y.value),isOpen:y.value},null,8,["isOpen"])):_("",!0)],64))}});let ut={};ut=window.chat_gpt.data;const Ge=vt({setup(){G("chatGptData",ut)},render:()=>bt(Ve)});Ge.mount("#main_chat_gpt");
