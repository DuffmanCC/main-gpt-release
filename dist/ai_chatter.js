import{d as $,r as x,o as p,c as g,b as l,w as f,e as y,t as C,g as Y,x as J,a as n,F as _,f as T,h as F,n as S,y as U,z as W,i as q,A as V,m as H,k as M,u as h,l as Q,p as X,q as Z,s as ee}from"./wug-style.js";import{a as te,b as ae,_ as se,c as O}from"./a-text.vue_vue_type_script_setup_true_lang.js";import{a as L,_ as oe}from"./a-select.vue_vue_type_script_setup_true_lang.js";import{_ as k}from"./a-checkbox.vue_vue_type_script_setup_true_lang.js";import{a as P,m as I,_ as le}from"./metabox-body.js";import{_ as A}from"./a-textarea.vue_vue_type_script_setup_true_lang.js";import{v as ie,a as B}from"./tools.js";const ne=["id","name","disabled","aria-errormessage"],re=["value"],de=["id"],me=["id"],z=$({__name:"a-select-multi",props:{options:{type:Array,default:()=>[{label:"",value:""}]},selectedOptions:{type:Array,default:()=>[]},label:{type:String,default:""},id:{type:String,default:""},help:{type:String,default:""},disabled:{type:Boolean,default:!1},atLeastOne:{type:Boolean,default:!1}},emits:["selected-options"],setup(r,{emit:b}){const u=r,v=b,m=x(u.selectedOptions),o=x(""),w=i=>{const s=i.target,d=Array.from(s.selectedOptions);u.atLeastOne&&d.length===0?o.value="Please select at least one option":o.value="",m.value=d.map(t=>parseInt(t.value)),v("selected-options",m.value)};return(i,s)=>(p(),g("label",{class:S(["tw-flex tw-flex-col tw-gap-2 tw-text-sm tw-relative tw-pb-6",{"tw-opacity-50 tw-cursor-not-allowed":r.disabled}])},[l(te,null,{default:f(()=>[y(C(r.label),1)]),_:1}),Y(n("select",{id:r.id,name:r.id,class:"!tw-leading-normal tw-w-full tw-border !tw-border-gray-300 !tw-rounded-md !tw-p-2 !tw-shadow disabled:tw-border-gray-200 disabled:tw-cursor-not-allowed","onUpdate:modelValue":s[0]||(s[0]=d=>m.value=d),multiple:"",disabled:r.disabled,onChange:w,"aria-errormessage":`${r.id}_error`},[(p(!0),g(_,null,T(r.options,d=>(p(),g("option",{key:d.value,value:d.value},C(d.label),9,re))),128))],40,ne),[[J,m.value]]),r.help?(p(),g("div",{key:0,id:`${r.id}_help`,class:"tw-font-light tw-text-brand-gray-dark tw-text-sm tw-max-w-xl"},C(r.help),9,de)):F("",!0),o.value?(p(),g("div",{key:1,id:`${r.id}_error`,class:"tw-text-red-500 tw-font-semibold tw-text-sm tw-absolute tw-bottom-0"},C(o.value),9,me)):F("",!0)],2))}}),ue={class:"tw-relative tw-group"},ce=["disabled"],pe={class:"tw-relative -tw-top-px tw-uppercase"},we=["id","name","value"],he={class:"tw-absolute tw-z-10 tw-p-2 tw-text-xs tw-bg-gray-100 tw-border tw-border-gray-100 tw-rounded-md tw-w-32 tw-bottom-10 tw-text-black tw-hidden group-hover:tw-block"},E=$({__name:"a-tooltip",props:{id:{type:String,default:""},value:Boolean,symbol:{type:String,default:""},disabled:{type:Boolean,default:!1}},emits:["activateTooltip"],setup(r,{emit:b}){const u=r,v=b,m=x(u.value),o=()=>{m.value=!m.value,v("activateTooltip",m.value)};return(w,i)=>(p(),g("div",ue,[n("button",{class:S(["tw-flex tw-justify-center tw-items-center tw-text-xl tw-h-8 tw-w-8 tw-rounded-full tw-text-white tw-transition-all tw-duration-300 disabled:tw-cursor-not-allowed disabled:tw-opacity-30",{"tw-bg-green-500":m.value,"tw-bg-gray-500":!m.value}]),onClick:U(o,["prevent"]),disabled:r.disabled},[n("span",pe,C(r.symbol),1),n("input",{type:"hidden",id:r.id,name:r.id,value:m.value,onInput:o},null,40,we)],10,ce),n("div",he,[W(w.$slots,"default")])]))}}),ge=n("p",{class:"tw-font-light tw-text-gray-700 tw-uppercase tw-text-sm tw-mb-2"}," Form Fields ",-1),fe={class:"tw-grid tw-grid-cols-3 tw-flex-col tw-gap-2 tw-max-w-xs tw-items-center"},be=n("div",{class:"tw-uppercase"},"Active",-1),ve=n("div",{class:"tw-uppercase"},"Mandatory",-1),Ce=n("div",{class:"tw-uppercase"},"Field name",-1),ye={class:"tw-flex tw-flex-col tw-gap-4"},xe=n("a",{href:"/wp-admin/edit.php?post_type=main_ai_campaign",target:"_blank",class:"tw-underline tw-text-brand-blue"},"Create Campaign?",-1),_e=$({__name:"contact-form",emits:["contact-form"],setup(r,{emit:b}){const u=q("aiChatterData");if(!u)throw new Error("aiChatterData is undefined");const v=b;function m(w,i,s,d){o.formFields=[...o.formFields.map(t=>t.label===w?{label:w,type:i,active:s,required:d}:t)]}const o=V({formFields:u.aiChat.formFields,showContactForm:u.aiChat.showContactForm,allowAiContactCampaigns:u.aiChat.allowAiContactCampaigns,aiContactCampaigns:u.aiChat.aiContactCampaigns,afterFormMessageSuccess:u.aiChat.afterFormMessageSuccess,afterFormMessageError:u.aiChat.afterFormMessageError});return H(o,w=>v("contact-form",w)),(w,i)=>(p(),g("section",null,[n("header",{class:S(["tw-bg-white tw-p-6 tw-border tw-rounded-t-xl",{"tw-rounded-b-xl":!o.showContactForm}])},[l(k,{label:"Show contact form",value:o.showContactForm,onChange:i[0]||(i[0]=s=>o.showContactForm=s),help:"If checked, after the limit message will be shown a contact form"},null,8,["value"])],2),o.showContactForm?(p(),M(I,{key:0,class:"tw-border tw-border-t-0"},{default:f(()=>[ge,n("div",fe,[be,ve,Ce,(p(!0),g(_,null,T(o.formFields,s=>(p(),g(_,{key:s.label},[l(P,{value:s.active,id:`active_${s.label}`,onSwitch:d=>m(s.label,s.type,d,s.required)},null,8,["value","id","onSwitch"]),l(k,{value:s.required,id:`required_${s.label}`,onChange:d=>m(s.label,s.type,s.active,d),disabled:!s.active},null,8,["value","id","onChange","disabled"]),n("div",null,C(s.label),1)],64))),128))]),n("div",ye,[l(E,{symbol:"g",id:"is_ai_contact_campaigns",onActivateTooltip:i[1]||(i[1]=s=>o.allowAiContactCampaigns=s),value:o.allowAiContactCampaigns},{default:f(()=>[y("if activated allow you to select a gpt leads gdpr campain")]),_:1},8,["value"]),l(z,{label:"AiContact Campaigns",id:"ai_contact_campaigns",class:"tw-max-w-lg",options:h(u).gdprCampaigns.map(s=>({label:s.title,value:s.id.toString()})),selectedOptions:o.aiContactCampaigns,disabled:!o.allowAiContactCampaigns,onSelectedOptions:i[2]||(i[2]=s=>o.aiContactCampaigns=s)},null,8,["options","selectedOptions","disabled"]),l(A,{label:"Success after message",value:o.afterFormMessageSuccess,help:"The message shown after the form has been submitted.",size:"sm",onInput:i[3]||(i[3]=s=>o.afterFormMessageSuccess=s)},null,8,["value"]),l(A,{label:"Error after message",value:o.afterFormMessageError,help:"The message shown after the form failed to submit.",size:"sm",onInput:i[4]||(i[4]=s=>o.afterFormMessageError=s)},null,8,["value"]),xe])]),_:1})):F("",!0)]))}}),Fe={class:"tw-font-arboria"},Ae=["name","value"],$e={class:"tw-flex tw-flex-col tw-gap-4"},Se={class:"tw-flex tw-gap-4 tw-items-center"},Oe=n("a",{class:"tw-underline tw-text-blue-500",href:"/wp-admin/edit.php?post_type=main_ai_campaign",target:"_blank"},"Create Campaign?",-1),Me={class:"tw-flex tw-gap-4"},ke={class:"tw-bg-gray-100 tw-rounded-xl tw-p-4 tw-w-96 tw-font-mono tw-text-base"},Ie={class:"tw-flex tw-items-center"},Ee=$({__name:"ai-chatter",setup(r){const b=q("aiChatterData");if(!b)throw new Error("aiChatterData is undefined");const{fieldName:u,modelNameValues:v,aiMemoriesValues:m,gdprCampaigns:o,aiChat:w,gdprSemaphore:i,shortcode:s}=b,d=x([]),t=V(w);function K(){navigator.clipboard.writeText(s),B(d,"success","Shortcode copied to clipboard")}function G(c){t.showContactForm=c.showContactForm,t.formFields=c.formFields,t.allowAiContactCampaigns=c.allowAiContactCampaigns,t.aiContactCampaigns=c.aiContactCampaigns,t.afterFormMessageSuccess=c.afterFormMessageSuccess,t.afterFormMessageError=c.afterFormMessageError}function N(c,a){return c==="never"?!1:c==="always"?!0:a}Q(()=>{const c=document.getElementById("publish");c&&c.addEventListener("click",function(a){const e=ie(t,i);e.length>0&&(a.preventDefault(),e.forEach(D=>{B(d,"error",D,0)}))})});function R(c){d.value=d.value.filter(a=>a.id!==c)}return(c,a)=>(p(),g("div",Fe,[n("input",{type:"hidden",name:h(u),value:JSON.stringify(t)},null,8,Ae),l(le,{title:"AI Chatter"}),l(I,null,{default:f(()=>[l(ae,{class:"tw-top-2"},{default:f(()=>[(p(!0),g(_,null,T(d.value,e=>(p(),M(se,{key:e.id,type:e.type,message:e.message,time:e.time,onClose:D=>R(e.id)},null,8,["type","message","time","onClose"]))),128))]),_:1}),l(P,{id:"is-active",label:"Is active",value:t.isActive,help:"Activate the chatter in the frontend.",onSwitch:a[0]||(a[0]=e=>t.isActive=e)},null,8,["value"]),l(L,{label:"Open AI model",class:"tw-max-w-lg",id:"model",options:h(v).map(e=>({label:e,value:e})),selectedOption:t.modelName,onSelectOption:a[1]||(a[1]=e=>t.modelName=e)},null,8,["options","selectedOption"]),l(L,{label:"AI memory",class:"tw-max-w-lg",options:h(m).map(e=>({label:e.name,value:e.name})),selectedOption:t.pineconeIndex,help:"One of your trained database indexes created in Pinecone.",onSelectOption:a[2]||(a[2]=e=>t.pineconeIndex=e)},null,8,["options","selectedOption"]),l(O,{type:"number",label:"TopK",class:"tw-max-w-lg",value:t.topK,help:"The number of responses to return.",onInput:a[3]||(a[3]=e=>t.topK=Number(e)),onEnter:a[4]||(a[4]=e=>t.topK=Number(e))},null,8,["value"]),l(A,{label:"Primer prompt",class:"tw-max-w-lg",value:t.primerPrompt,help:"Your prompt to start the conversation.",onInput:a[5]||(a[5]=e=>t.primerPrompt=e)},null,8,["value"]),l(O,{label:"Initail message",class:"tw-max-w-lg",value:t.initMessage,help:"Your initial message.",onInput:a[6]||(a[6]=e=>t.initMessage=e),onEnter:a[7]||(a[7]=e=>t.initMessage=e)},null,8,["value"]),n("div",$e,[n("div",Se,[l(E,{symbol:"h",onActivateTooltip:a[8]||(a[8]=e=>t.hasAiChat=e),value:t.hasAiChat},{default:f(()=>[y("If selected, the AiChat will store the content of the messages")]),_:1},8,["value"]),l(E,{symbol:"g",onActivateTooltip:a[9]||(a[9]=e=>t.allowAiChatCampaigns=e),value:N(h(i),t.allowAiChatCampaigns),disabled:h(i)==="never"||h(i)==="always"},{default:f(()=>[y("If selected, before to proceed with the chat the user will be request to accept the selected AI GDPR Campaigns")]),_:1},8,["value","disabled"])]),l(z,{id:"ai-chat-campaigns",class:"tw-max-w-lg",label:"Gdpr campaigns",options:h(o).map(e=>({label:e.title,value:e.id.toString()})),selectedOptions:t.aiChatCampaigns,disabled:!N(h(i),t.allowAiChatCampaigns),atLeastOne:h(i)==="always",help:"Select the GDPR campaigns that the user will be requested to accept before to proceed with the chat.",onSelectedOptions:a[10]||(a[10]=e=>t.aiChatCampaigns=e)},null,8,["options","selectedOptions","disabled","atLeastOne"]),Oe]),n("section",null,[n("header",{class:S(["tw-bg-white tw-p-6 tw-border tw-rounded-t-xl",{"tw-rounded-b-xl":!t.limitChat}])},[l(k,{label:"Limit chat messages",value:t.limitChat,onChange:a[11]||(a[11]=e=>t.limitChat=e),help:"To avoid over expensive chat, or to drive the customer to an action, you can select this checkbox to limit the amount of messages of a chat"},null,8,["value"])],2),t.limitChat?(p(),M(I,{key:0,class:"tw-border tw-border-t-0"},{default:f(()=>[l(O,{label:"Number of messages",type:"number",min:1,value:t.questionsLimit,help:"After this amount of messages will be shown the limit message.",onInput:a[12]||(a[12]=e=>t.questionsLimit=Number(e)),onEnter:a[13]||(a[13]=e=>t.questionsLimit=Number(e))},null,8,["value"]),l(A,{label:"Limit message",value:t.beforeFormMessage,help:"The message shown when the number of messages is reached.",size:"sm",onInput:a[14]||(a[14]=e=>t.beforeFormMessage=e)},null,8,["value"]),l(_e,{onContactForm:a[15]||(a[15]=e=>G(e))})]),_:1})):F("",!0)]),n("div",Me,[n("code",ke,C(h(s)),1),n("div",Ie,[l(oe,{onClick:K},{default:f(()=>[y("Copy to clipboard")]),_:1})])])]),_:1})]))}});let j={};j=window.ai_chatter.data;const Te=X({setup(){ee("aiChatterData",j)},render:()=>Z(Ee)});Te.mount("#main_ai_chatter");
